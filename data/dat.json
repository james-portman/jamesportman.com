{
    "categories": {
        "linux": {
            "title": "Linux",
            "posts": {
                "bash-loops": {
                    "title": "Bash loops",
                    "content": "for i in {1..5}\ndo\necho \"Welcome $i times\"\ndone\nfor i in $( ls ); do\necho item: $i\ndone\nCOUNTER=0\nwhile [ $COUNTER -lt 10 ]; do\necho The counter is $COUNTER\nlet COUNTER=COUNTER+1\ndone\nCOUNTER=20\nuntil [ $COUNTER -lt 10 ]; do\necho COUNTER $COUNTER\nlet COUNTER-=1\ndone"
                },
                "crontab-usage": {
                    "title": "Crontab usage",
                    "content": "# display current users crontab:\n# crontab -l\n#\n# edit crontab:\n# crontab -e\n#\n# display / edit another users crontab:\n# crontab -u webserver -e\n#\n# To send output to an email address: (sendmail must be working already)\nMAILTO=user@domain.com\n#\n# Format: Minute, hour, day of month (1-31), month(1-12), day of week(0-6 (sunday is 0)), command\n#\n# Examples:\n#\n* * * * * /scripts/every-minute.sh\n*/1 * * * * /scripts/every-minute.sh\n*/10 * * * /scripts/every-ten-minutes.sh\n0 * * * * /scripts/every-hour.sh\n0 */1 * * * /scripts/every-hour.sh\n0 8-17 * * * /scripts/working-hours-every-hour.sh\n0 8-17 * * 1-5 /scripts/working-hours-every-hour-monday-to-friday.sh\n0 0,12 * * * /scripts/twice-a-day.sh\n# special:\n# hourly – same as 0 * * * *\n@hourly /scripts/hourly.sh\n# daily – same as 0 0 * * *\n@daily /scripts/daily.sh\n# yearly – same as: 0 0 1 1 *\n@yearly /scripts/yearly.sh\n# Run at startup\n@reboot /scripts/on-startup.sh\n# Dont save or send the output anywhere\n* * * * /scripts/silent.sh 2>&1 > /dev/null"
                },
                "dell-poweredge-perc-mega-raid-raid-controller-commands": {
                    "title": "Dell PowerEdge PERC Mega raid – raid controller commands",
                    "content": "http://www.lsi.com/support/downloads/megaraid/miscellaneous/linux/1.01.40_Linux_Cli.zip\nAdp – adaptor\nLD – logical drive (virtual drive)\nPD – Physical drive\nBBU – battery backup\nMegaCli -AdpAllInfo -aALL\nMegaCli -CfgDsply -aALL\nMegaCli -AdpEventLog -GetEvents -f events.log -aALL && cat events.log\nMegaCli -EncInfo -aALL\nMegaCli -LDInfo -Lall -aALL\nMegaCli -PDList -aALL\nMegaCli -PDInfo -PhysDrv [E:S] -aALL\nMegaCli -AdpBbuCmd -aALL\nSilence active alarm\nMegaCli -AdpSetProp AlarmSilence -aALL\nDisable alarm\nMegaCli -AdpSetProp AlarmDsbl -aALL\nEnable alarm\nMegaCli -AdpSetProp AlarmEnbl -aALL\nCreate RAID 0, 1, 5 drive\nMegaCli -CfgLdAdd -r(0|1|5) [E:S, E:S, ...] -aN\nCreate RAID 10 drive\nMegaCli -CfgSpanAdd -r10 -Array0[E:S,E:S] -Array1[E:S,E:S] -aN\nRemove drive\nMegaCli -CfgLdDel -Lx -aN\n6 PHYSICAL DRIVE MANAGEMENT\nSet state to offline\nMegaCli -PDOffline -PhysDrv [E:S] -aN\nSet state to online\nMegaCli -PDOnline -PhysDrv [E:S] -aN\nMark as missing\nMegaCli -PDMarkMissing -PhysDrv [E:S] -aN\nPrepare for removal\nMegaCli -PdPrpRmv -PhysDrv [E:S] -aN\nReplace missing drive\nMegaCli -PdReplaceMissing -PhysDrv [E:S] -ArrayN -rowN -aN\nThe number N of the array parameter is the Span Reference you get using „MegaCli -CfgDsply -aALL“ and the number N of the row parameter is the Physical Disk in that span or array starting with zero (it’s not the physical disk’s slot!).\nRebuild drive\nMegaCli -PDRbld -Start -PhysDrv [E:S] -aN\nMegaCli -PDRbld -Stop -PhysDrv [E:S] -aN\nMegaCli -PDRbld -ShowProg -PhysDrv [E:S] -aN\nClear drive\nMegaCli -PDClear -Start -PhysDrv [E:S] -aN\nMegaCli -PDClear -Stop -PhysDrv [E:S] -aN\nMegaCli -PDClear -ShowProg -PhysDrv [E:S] -aN\nBad to good\nMegaCli -PDMakeGood -PhysDrv[E:S] -aN\nChanges drive in state Unconfigured-Bad to Unconfigured-Good.\n7 HOT SPARE MANAGEMENT\nSet global hot spare\nMegaCli -PDHSP -Set -PhysDrv [E:S] -aN\nRemove hot spare\nMegaCli -PDHSP -Rmv -PhysDrv [E:S] -aN\nSet dedicated hot spare\nMegaCli -PDHSP -Set -Dedicated -ArrayN,M,… -PhysDrv [E:S] -aN\n8 WALKTHROUGH: CHANGE/REPLACE A DRIVE\nSet the drive offline, if it is not already offline due to an error\nMegaCli -PDOffline -PhysDrv [E:S] -aN\nMark the drive as missing\nMegaCli -PDMarkMissing -PhysDrv [E:S] -aN\nPrepare drive for removal\nMegaCli -PDPrpRmv -PhysDrv [E:S] -aN\nChange/replace the drive\nIf you’re using hot spares then the replaced drive should become your new hot spare drive\nMegaCli -PDHSP -Set -PhysDrv [E:S] -aN\nIn case you’re not working with hot spares, you must re-add the new drive to your RAID virtual drive and start the rebuilding\nMegaCli -PdReplaceMissing -PhysDrv [E:S] -ArrayN -rowN -aN\nMegaCli -PDRbld -Start -PhysDrv [E:S] -aN"
                },
                "dynamic-virtual-hosts-on-apache": {
                    "title": "Dynamic virtual document roots/vhosts on Apache",
                    "content": "Listen 80\nVirtualDocumentRoot /var/www/vhosts/%0\nLogFormat \"%V %h %l %u %t \"%r\" %s %b\" vcommon\nCustomLog logs/access_log vcommon\nConfig with overridden subdomains to one directory;\nListen 80\nLogFormat \"%V %h %l %u %t \"%r\" %s %b\" vcommon\nCustomLog logs/access_log vcommon\nNameVirtualHost *:80\nServerName default\nVirtualDocumentRoot /var/www/vhosts/%0\nServerName subdomain.domain.tld\nServerAlias *.domain.tld\nDocumentRoot /var/www/vhosts/subdomain.domain.tld"
                },
                "fast-website": {
                    "title": "Making a website load in one request… and very quickly",
                    "content": "So this might not really be possible with most websites but here are some of the ways to speed up a website,\nfor my own reference in future, and if it can help anybody else too\nHere are SOME ways to improve page load times/size:\nTake advice from Google\nSince that is partly who you (should) want to impress to get your website ranked in searches, as well as speeding up the site for visitors\nSee https://developers.google.com/speed/pagespeed/insights/\nInstall pagespeed\nSee https://developers.google.com/speed/pagespeed/module\nInline CSS and Javascript\nThis can be done a couple of ways\n1) Manually\nThis involves manually taking all css/javascript that your website needs and writing it directly into your html pages.\nIf you are using a CMS like WordPress you could do this directly in the themes header.php file.\n2) Use PHP include\nThis is the way I am currently doing it for css from header.php;\n3) pagespeed inline CSS and Javascript\nSee https://developers.google.com/speed/pagespeed/module/filter-css-inline\nand https://developers.google.com/speed/pagespeed/module/filter-js-inline\nMinification\nMinification can give an impressive reduction in file size\nCompression\nEven after minification, files can be compressed further!\nThis is done with gzip/deflate which is possible in a number of ways\n1) Apache mod_deflate\nAddOutputFilterByType DEFLATE text/html text/plain text/xml text/css text/javascript application/javascript application/x-javascript\n2) in Varnish\nif (req.url !~ \".(jpg|jpeg|png|gif|pdf|zip|gz)$\") {\nset beresp.do_gzip = true;\n}\nVarnish caching\nSee https://www.varnish-cache.org/\nMore when I remember"
                },
                "general-server-tuning": {
                    "title": "General server tuning",
                    "content": "Linux disk schedulers\ncat /sys/block/sda/queue/scheduler\n(deadline may be good for mysql servers, noop in general)\nSwappiness\ncat /proc/sys/vm/swappiness\necho 0 > /proc/sys/vm/swappiness\n(do not swap anything until RAM is exhausted)\nDisk readahead\nblockdev –setra 65536 /dev/md0\necho 1024 > /sys/block/sda/queue/read_ahead_kb\nNoatime\nmount -o remount,noatime /\nvi /etc/sysctl.conf\nsysctl -p /etc/sysctl.conf\nnet.ipv4.ip_nonlocal_bind = 1\nnet.ipv4.tcp_tw_reuse = 1\nnet.ipv4.ip_local_port_range = 1024 65023\nnet.ipv4.tcp_max_tw_buckets = 400000\nnet.ipv4.tcp_max_orphans = 512000\nnet.ipv4.tcp_synack_retries = 3\nnet.ipv4.tcp_max_syn_backlog = 450000\nnet.ipv4.tcp_timestamps = 1\nnet.ipv4.tcp_rmem = 10240 87380 12582912\nnet.ipv4.tcp_wmem = 10240 87380 12582912\nnet.ipv4.tcp_mem = 262144 393216 524288\nnet.ipv4.tcp_window_scaling = 1\nnet.ipv4.tcp_sack = 1\nnet.ipv4.tcp_no_metrics_save = 1\nnet.core.somaxconn = 600000\nnet.core.netdev_max_backlog = 400000\nnet.core.wmem_max=12582912\nnet.core.rmem_max=12582912\nnet.ipv4.tcp_fin_timeout = 2"
                },
                "group-on-centos-7": {
                    "title": "Cgroup on CentOS 7",
                    "content": "Stolen from kernel docs + fudged a bit\nInterrupt shielding\nKernel Space\nIn order to shield CPUs from individual interrupts being serviced on them you have to make sure that the following kernel configuration parameter is set:\nCONFIG_IRQBALANCE\nUser Space\nThen make sure that the interrupts are not automatically balanced by the irqbalance daemon. This daemon is started from the irqbalance init script. To disable once do:\n# /etc/init.d/irqbalance stop\nTo disable after next reboot do:\n# chkconfig irqbalance off\nAfter this you can change the CPU affinity mask of each interrupt by doing:\n# echo hex_mask > /proc/irq//smp_affinity\nTo check that the affinity mask has been set you can check the contents of the smp_affinity file.\nNOTE!\nThe mask is updated the next time an interrupt is serviced. So you may not see the change immediately.\nMore information can be found in /usr/src/kernel/Documentation/IRQ-affinity.txt.\nProcess shielding\nThe kernel has an cpuset feature that allows you to create cpusets for real-time purposes. The kernel interface is proc filesystem based. It is described in /usr/src/kernel/Documentation/cgroups/cpusets.txt.\nEach cpuset is represented by a directory in the cgroup file system containing (on top of the standard cgroup files) the following files describing that cpuset:\n– cpus: list of CPUs in that cpuset\n– mems: list of Memory Nodes in that cpuset\n– memory_migrate flag: if set, move pages to cpusets nodes\n– cpu_exclusive flag: is cpu placement exclusive?\n– mem_exclusive flag: is memory placement exclusive?\n– mem_hardwall flag: is memory allocation hardwalled\n– memory_pressure: measure of how much paging pressure in cpuset\n– memory_spread_page flag: if set, spread page cache evenly on allowed nodes\n– memory_spread_slab flag: if set, spread slab cache evenly on allowed nodes\n– sched_load_balance flag: if set, load balance within CPUs on that cpuset\n– sched_relax_domain_level: the searching range when migrating tasks\nIn addition, the root cpuset only has the following file:\n– memory_pressure_enabled flag: compute memory_pressure?\nHere is a quick example of how to use cpuset to reserve one cpu for your real-time process on a 4 cpu machine:\n# mkdir /sys/fs/cgroup/cpuset/rt0\n# echo 0 > /sys/fs/cgroup/cpuset/rt0/cpus\n# echo 0 > /sys/fs/cgroup/cpuset/rt0/mems\n# echo 1 > /sys/fs/cgroup/cpuset/rt0/cpu_exclusive\n# echo $RT_PROC_PID > /sys/fs/cgroup/cpuset/rt0/tasks\n# mkdir /sys/fs/cgroup/cpuset/system\n# echo 1-3 > /sys/fs/cgroup/cpuset/system/cpus\n# echo 0 > /sys/fs/cgroup/cpuset/system/mems\n# echo 1 > /sys/fs/cgroup/cpuset/system/cpu_exclusive\n# for pid in $(cat /sys/fs/cgroup/cpuset/tasks); do /bin/echo $pid > /sys/fs/cgroup/cpuset/system/tasks; done"
                },
                "linux-clear-in-memory-disk-cache": {
                    "title": "Linux clear in memory disk cache",
                    "content": "echo 3 > /proc/sys/vm/drop_caches"
                },
                "linux-software-raid-mdadm": {
                    "title": "Linux software raid – mdadm",
                    "content": "Copy partition table over from one disk to another:\n(this will completely wipe the second disk!)\nsfdisk -d /dev/sdx | sfdisk /dev/sdy\nThe second disk must be equal size or larger!\nTo remove the raid data from a drive previously in an array:\nmdadm –zero-superblock /dev/sdx\nTo get the details of raid arrays:\ncat /proc/mdstat\nand\nmdadm –detail /dev/md*\nFind the raid config file:\nfind /etc/ -name “mdadm.conf”\nCreate an array\nmdadm –create\ncreate options\n-n, –raid-devices=\nnumber of devices in the array\n-c, –chunk=\nchunk size in kibibytes\ndefault is 512KB\n-l, –level=\nraid level e.g.:\nlinear, raid0, 0, stripe (100% storage, much faster, each drive increases failure risk)\nraid1, 1, mirror (50% storage, better redundancy)\nraid5, 5 (n-1 storage, redundancy)\nraid6, 6 (n-2 storage, redundancy)\nraid10, 10 (50% storage, much faster)\nmultipath, mp\nfaulty\ncontainer"
                },
                "linux-touchpad-settings": {
                    "title": "Linux touchpad settings",
                    "content": "Tap sensitivity – higher values will stop the cursor moving when you just tap for a click or right click\nsynclient FingerHigh=45\nsynclient FingerLow=40"
                },
                "mysql-settings": {
                    "title": "MYSQL settings",
                    "content": "expire_logs_days = 14\ninnodb_additional_mem_pool_size=20M\ninnodb_buffer_pool_size=64M\ninnodb_flush_log_at_trx_commit=2\nkey_buffer_size=64M\nmax_heap_table_size=64M\nopen-files-limit=4096\nquery_cache_limit=4M\nquery_cache_size=64M\nquery_cache_type=1\ntable_cache=3000\nthread_cache_size = 64\ntmp_table_size=64M\nwait_timeout=600\n#\n# optional settings\n#\n# log=/var/lib/mysql-all-queries.log\n# (log all mysql queries)\n# innodb_lock_wait_timeout=120\n# innodb_log_buffer_size=16M\n# innodb_log_file_size=512M\n# innodb_thread_concurrency = 9\n# log_warnings=2\n# max_allowed_packet = 64M\n# max_connections=100\n# myisam_sort_buffer_size = 64M\n# read_buffer_size = 4M\n# read_rnd_buffer_size = 2M\n# set global\n# sort_buffer_size = 4M\n# skip-networking\n#\n# for tmp tables into ram\n# mkdir /var/lib/mysqltmp\n# chown mysql:mysql /var/lib/mysqltmp\n# add to fstab replacing uid and gid with mysql ids\n# tmpfs /var/lib/mysqltmp tmpfs size=1024M,mode=755,uid=101,gid=103 0 0\n# tmpdir=/var/lib/mysqltmp\n#\n# log_slow_queries = /var/log/mysql-slow.log\n# long_query_time = 5\n# also need to run:\n# # touch /var/log/mysql-slow.log\n# then\n# # chown mysql:mysql /var/log/mysql-slow.log\n# various commands\n# PURGE BINARY LOGS BEFORE ‘2012-11-20 00:00:00′;\n#\n# [client]\n# user=\n# pass=\n#\n# skip-grant-tables\n# http://www.day32.com/MySQL/"
                },
                "nginx-rewrites": {
                    "title": "NGINX rewrites",
                    "content": "location /james-and-the-beanstalk/ {\nindex index.php;\nif (!-e $request_filename) {\nrewrite . /james-and-the-beanstalk/index.php last;\n}\n}"
                },
                "rsync-cheat-sheet": {
                    "title": "Rsync cheat sheet",
                    "content": "rsync common options/usage\nlocal disk to disk\nrsync -avp * /dest/\nserver to server\nrsync -avpze ssh root@server:/dir/* ./\n-v verbose\n-q quiet\n-a archive (-rlptgoD)\n-r recursive\n-u update\n-z compress\n–progress\n-e (ssh)"
                },
                "simple-python-http-server": {
                    "title": "Simple python http server",
                    "content": "This will start a very simple web server and serve all files in the current directory\nThere is NO security at all!\npython -m SimpleHTTPServer 8080\nhttp://server.fqdns.tld:8080/"
                },
                "test-pop3-with-telnet": {
                    "title": "Test POP3 connection with telnet",
                    "content": "telnet mail.domain.tld 110\nType: user username@domain.tld\nType: pass passwordxxxxx\nType: list\nType: retr 1 (to read the first email)\nType: quit\nOther Telnet commands:\nstat = Status of mailbox\ndele N = delete mail number “N”"
                },
                "varnish-redirects": {
                    "title": "Varnish redirects",
                    "content": "This will send certain clients a HTTP 301 redirect to another page/website\nsub vcl_recv {\nif (req.http.User-Agent ~ “iPad” ||\nreq.http.User-Agent ~ “iPhone” ||\nreq.http.User-Agent ~ “Android”) {\nset req.http.Location = “http://mobile.website.com”;\nerror 750 “Permanently moved”;\n}\n}\nsub vcl_error {\nif (obj.status == 750) {\nset obj.http.location = req.http.Location;\nset obj.status = 301;\nreturn (deliver);\n}\n}"
                },
                "website-redirects": {
                    "title": "Website redirects",
                    "content": "htaccess redirects\n\nRedirect to another page\nRedirect \/old-index.html http:\/\/www.mynewwebsite.com\/foldername\/new-index.html\n\nRedirect to another website\nRedirect 301 \/ http:\/\/www.mynewwebsite.com\n\nRedirect page to subdirectory\nRedirect \/test.html http:\/\/www.mynewwebsite.com\/foldername\n\nRedirect filepaths\nRedirect \/foldername\/filename.html http:\/\/www.mynewwebsite.com\/foldername2\/filename.html\n\nTo change file extention\nRedirectMatch 301 (.*)\\.html$ http:\/\/www.example.com$1.php\n\nSpecifying folder default page\nDirectoryIndex index.php\n\nRedirect www to non-www\nRewriteEngine On\nRewriteCond %{HTTP_HOST} ^www\\.mynewwebsite\\.com$ [NC]\nRewriteRule ^(.*)$ http:\/\/mynewwebsite.com\/$1 [L,R=301]\n\nRedirect non-www to www\nRewriteEngine On\nRewriteCond %{HTTP_HOST} !^www\\.mynewwebsite\\.com$ [NC]\nRewriteRule ^(.*)$ http:\/\/www.mynewwebsite.com\/$1 [L,R=301]\n\nGive 307 \u2018Site Under Maintenance\u2019 Header on all webpage requests\nCreate a temporary file called 307.php and inside it place the message to give to your visitors and upload it to your public root directory.\nNext create a totally separate .htaccess file called .htaccess.307 with the following text:\nRewriteEngine On\nRewriteBase \/\n# Before using this htaccess, you have to change this digits to match your\n# own IP address: This will keep you with access to the site. as long as\n# your IP doesn\u2019t change: http:\/\/whatismyip.com\nRewriteCond %{REMOTE_ADDR} !^123\\.123\\.123\\.123$\n# The last 2 lines take the site offline. the basically say if: page request is\n# NOT 307.php, show 307.php but only once. Stops it from looping endlessly.\nRewriteCond %{REQUEST_URI} !^\/307\\.php$\n# The browser gets this bit, so you need the full website address.\nRewriteRule ^(.*)$ http:\/\/www.yoursite.com\/307.php [R=307,L]\nThe above includes comments for your convenience. To get the redirect up and running, rename your existing .htaccess file to live.htaccess then rename this one to .htaccess\n\nAlternative Redirect 1: Meta Refresh (in html head)\n<meta http-equiv=\"refresh\" content=\"0; url=http:\/\/www.new-website.com\" \/>\nTo redirect after 5 seconds:\n<meta http-equiv=\"refresh\" content=\"5; url=http:\/\/www.new-website.com\" \/>\n\nAlternative Redirect 2: PHP Header Redirect\n\n<?php\nheader (\u2018HTTP\/1.1 301 Moved Permanently\u2019);\nheader( \u201chttp:\/\/www.new-website.com\u201d );\nexit;\n?>\n\nor\n\n<?php\nheader (\u201cLocation: http:\/\/www.new-website.com\u201d);\nexit;\n?>"
                }
            }
        },
        
        
        "coding": {
            "title": "Coding",
            "posts": {
                "axis-ip-camera-stream-viewer": {
                    "title": "Axis IP Camera stream viewer (Android app)",
                    "content": "This is the video version of my first Android app,\nyou can connect and watch Axis IP cameras over the internet or local network\n\nThe original version loaded still images from the camera rather than video\n\nAxis IP camera stream viewer Android app on the play store"
                },
                "chain-reaction-android-game": {
                    "title": "Chain reaction (Android game)",
                    "content": "It’s a pretty simple but addictive game, and seems impossible to complete!\n\nChain reaction Android game on the play store"
                },
                "encrypted-chat": {
                    "title": "Encrypted chat (Android app)",
                    "content": "In progress…\nChat service/app,Private/Public key encryption used,\nencrypted communication between client and server,\nmessage content also encrypted with destination users public key so cannot be read if\nintercepted at any point,\nprivate key always stored on client device (mobile phone/tablet), never transmitted or shared\n\nPotential for website access to messages but would need heavy use of Javascript to\nencrypt/decrypt in the browser"
                }
            }
        }
    }
}